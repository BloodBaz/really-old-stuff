	.data
	.globl	__mage_s_pal
__mage_s_pal:
	.dc.w	0
	.dc.w	1536
	.dc.w	2048
	.dc.w	2560
	.dc.w	4
	.dc.w	8
	.dc.w	10
	.dc.w	2730
	.dc.w	546
	.dc.w	582
	.dc.w	1128
	.dc.w	1676
	.dc.w	2560
	.dc.w	102
	.dc.w	170
	.dc.w	238
	.globl	_mage_anim
_mage_anim:
	.dc.w	0
	.dc.w	0
	.dc.w	0
	.dc.w	35
	.dc.w	1
	.dc.w	0
	.dc.w	0
	.dc.w	16
	.dc.w	15
	.dc.w	2
	.dc.w	0
	.dc.w	0
	.dc.w	32
	.dc.w	15
	.dc.w	3
	.dc.w	0
	.dc.w	0
	.dc.w	16
	.dc.w	15
	.dc.w	0
	.dc.w	0
	.dc.w	0
	.dc.w	0
	.dc.w	15
	.dc.w	5
	.dc.w	-3
	.dc.w	-6
	.dc.w	48
	.dc.w	7
	.dc.w	6
	.dc.w	-6
	.dc.w	-8
	.dc.w	48
	.dc.w	7
	.dc.w	7
	.dc.w	-9
	.dc.w	-10
	.dc.w	64
	.dc.w	7
	.dc.w	8
	.dc.w	-12
	.dc.w	-11
	.dc.w	64
	.dc.w	15
	.dc.w	0
	.dc.w	0
	.dc.w	0
	.dc.w	0
	.dc.w	15
	.dc.w	10
	.dc.w	0
	.dc.w	0
	.dc.w	80
	.dc.w	10
	.dc.w	11
	.dc.w	2
	.dc.w	0
	.dc.w	96
	.dc.w	10
	.dc.w	12
	.dc.w	6
	.dc.w	0
	.dc.w	112
	.dc.w	20
	.dc.w	0
	.dc.w	0
	.dc.w	0
	.dc.w	0
	.dc.w	15
	.dc.w	14
	.dc.w	0
	.dc.w	0
	.dc.w	128
	.dc.w	10
	.dc.w	15
	.dc.w	2
	.dc.w	0
	.dc.w	144
	.dc.w	10
	.dc.w	16
	.dc.w	6
	.dc.w	0
	.dc.w	160
	.dc.w	20
	.dc.w	0
	.dc.w	0
	.dc.w	0
	.dc.w	0
	.dc.w	15
	.dc.w	18
	.dc.w	0
	.dc.w	0
	.dc.w	176
	.dc.w	10
	.dc.w	19
	.dc.w	0
	.dc.w	0
	.dc.w	192
	.dc.w	10
	.dc.w	20
	.dc.w	0
	.dc.w	0
	.dc.w	208
	.dc.w	10
	.dc.w	21
	.dc.w	0
	.dc.w	0
	.dc.w	224
	.dc.w	10
	.dc.w	22
	.dc.w	0
	.dc.w	0
	.dc.w	208
	.dc.w	10
	.dc.w	23
	.dc.w	0
	.dc.w	0
	.dc.w	224
	.dc.w	10
	.dc.w	24
	.dc.w	0
	.dc.w	0
	.dc.w	208
	.dc.w	10
	.dc.w	0
	.globl	_mage_anim_def
_mage_anim_def:
	.dc.l	_mage_anim
	.dc.w	4
	.dc.w	9
	.dc.w	13
	.dc.w	17
	.dc.w	5
	.dc.w	10
	.dc.w	40
	.text
	.globl	_show_sprite_32x32
_show_sprite_32x32:
	link	a6,#0
	move.w	#512,-(sp)
	move.w	22(a6),d0
	lsl.w	#5,d0
	move.w	d0,-(sp)
	moveq.l	#0,d0
	move.w	20(a6),d0
	lsl.l	#5,d0
	add.l	16(a6),d0
	move.l	d0,-(sp)
	jsr	_dma_vram_copy
	addq.w	#8,sp
	move.w	14(a6),d0
	or.w	22(a6),d0
	move.w	d0,-(sp)
	move.w	#3840,-(sp)
	move.w	12(a6),-(sp)
	move.w	10(a6),-(sp)
	move.w	8(a6),-(sp)
	jsr	_def_sprite
	unlk	a6
	rts
	.text
	.globl	_init_spr_anim
_init_spr_anim:
	link	a6,#0
	move.l	d3,-(sp)
	move.l	30(a6),d3
	move.l	d3,a0
	move.w	8(a6),4(a0)
	move.l	d3,a0
	move.w	10(a6),(a0)
	move.l	d3,a0
	move.w	12(a6),2(a0)
	move.l	d3,a0
	move.l	14(a6),6(a0)
	move.l	d3,a0
	move.w	18(a6),10(a0)
	move.l	d3,a0
	move.l	20(a6),12(a0)
	move.l	d3,a0
	move.w	24(a6),20(a0)
	move.l	d3,a0
	move.w	#0,18(a0)
	move.l	d3,a0
	moveq.l	#10,d0
	mulu	18(a0),d0
	moveq.l	#0,d1
	move.w	d0,d1
	move.l	d3,a0
	add.l	12(a0),d1
	move.l	d1,a0
	move.l	d3,a1
	move.w	6(a0),16(a1)
	move.l	d3,a0
	move.l	26(a6),22(a0)
	move.l	d3,a0
	move.l	#0,26(a0)
	move.l	d3,a0
	move.w	#0,30(a0)
	move.l	(sp)+,d3
	unlk	a6
	rts
	.text
	.globl	_set_spr_anim
_set_spr_anim:
	link	a6,#0
	movem.l	d3/d4,-(sp)
	move.w	12(a6),d4
	move.l	8(a6),d3
	move.l	d3,a0
	move.w	d4,18(a0)
	move.l	d3,a0
	moveq.l	#10,d0
	mulu	18(a0),d0
	moveq.l	#0,d1
	move.w	d0,d1
	move.l	d3,a0
	add.l	12(a0),d1
	move.l	d1,a0
	move.l	d3,a1
	move.w	6(a0),16(a1)
	move.l	d3,a0
	move.l	22(a0),a0
	move.w	d4,d0
	cmp.w	6(a0),d0
	bne	L9
	move.l	d3,a0
	move.l	22(a0),a0
	move.l	d3,a1
	move.w	12(a0),30(a1)
L8:
	movem.l	(sp)+,d3/d4
	unlk	a6
	rts
L9:
	move.l	d3,a0
	move.l	22(a0),a0
	move.w	d4,d0
	cmp.w	8(a0),d0
	bne	L11
	move.l	d3,a0
	move.l	22(a0),a0
	move.l	d3,a1
	move.w	14(a0),30(a1)
	bra	L8
L11:
	move.l	d3,a0
	move.l	22(a0),a0
	move.w	d4,d0
	cmp.w	10(a0),d0
	bne	L8
	move.l	d3,a0
	move.l	22(a0),a0
	move.l	d3,a1
	move.w	16(a0),30(a1)
	bra	L8
	.text
	.globl	_handle_spr_anim
_handle_spr_anim:
	link	a6,#0
	move.l	d3,-(sp)
	move.l	8(a6),d3
	move.l	d3,a0
	tst.w	20(a0)
	beq	L17
	move.l	d3,a0
	move.w	10(a0),-(sp)
	move.l	d3,a0
	moveq.l	#10,d0
	mulu	18(a0),d0
	moveq.l	#0,d1
	move.w	d0,d1
	move.l	d3,a0
	add.l	12(a0),d1
	move.l	d1,a0
	move.w	4(a0),-(sp)
	move.l	d3,a0
	move.l	6(a0),-(sp)
	move.w	#18432,-(sp)
	move.l	d3,a0
	moveq.l	#10,d0
	mulu	18(a0),d0
	moveq.l	#0,d1
	move.w	d0,d1
	move.l	d3,a0
	add.l	12(a0),d1
	move.l	d1,a0
	move.l	d3,a1
	move.w	2(a1),d0
	add.w	2(a0),d0
	move.w	d0,-(sp)
	move.l	d3,a0
	moveq.l	#10,d0
	mulu	18(a0),d0
	moveq.l	#0,d1
	move.w	d0,d1
	move.l	d3,a0
	add.l	12(a0),d1
	move.l	d1,a0
	move.l	d3,a1
	move.w	(a1),d0
	sub.w	(a0),d0
	move.w	d0,-(sp)
	move.l	d3,a0
	move.w	4(a0),-(sp)
	jsr	_show_sprite_32x32
	lea	16(sp),sp
L18:
	move.l	d3,a0
	subq.w	#1,16(a0)
	move.l	d3,a0
	tst.w	16(a0)
	bne	L19
	move.l	d3,a0
	moveq.l	#10,d0
	mulu	18(a0),d0
	moveq.l	#0,d1
	move.w	d0,d1
	move.l	d3,a0
	add.l	12(a0),d1
	move.l	d1,a0
	move.l	d3,a1
	move.w	8(a0),18(a1)
	move.l	d3,a0
	moveq.l	#10,d0
	mulu	18(a0),d0
	moveq.l	#0,d1
	move.w	d0,d1
	move.l	d3,a0
	add.l	12(a0),d1
	move.l	d1,a0
	move.l	d3,a1
	move.w	6(a0),16(a1)
L19:
	move.l	d3,a0
	tst.w	30(a0)
	beq	L16
	move.l	d3,a0
	subq.w	#1,30(a0)
	move.l	d3,a0
	tst.w	30(a0)
	bne	L16
	move.l	d3,a0
	tst.l	26(a0)
	beq	L16
	move.l	d3,a0
	move.l	26(a0),a0
	move.l	22(a0),a0
	move.w	4(a0),-(sp)
	move.l	d3,a0
	move.l	26(a0),-(sp)
	jsr	_set_spr_anim
	addq.w	#6,sp
L16:
	move.l	(sp)+,d3
	unlk	a6
	rts
L17:
	move.l	d3,a0
	move.w	10(a0),-(sp)
	move.l	d3,a0
	moveq.l	#10,d0
	mulu	18(a0),d0
	moveq.l	#0,d1
	move.w	d0,d1
	move.l	d3,a0
	add.l	12(a0),d1
	move.l	d1,a0
	move.w	4(a0),-(sp)
	move.l	d3,a0
	move.l	6(a0),-(sp)
	move.w	#16384,-(sp)
	move.l	d3,a0
	moveq.l	#10,d0
	mulu	18(a0),d0
	moveq.l	#0,d1
	move.w	d0,d1
	move.l	d3,a0
	add.l	12(a0),d1
	move.l	d1,a0
	move.l	d3,a1
	move.w	2(a1),d0
	add.w	2(a0),d0
	move.w	d0,-(sp)
	move.l	d3,a0
	moveq.l	#10,d0
	mulu	18(a0),d0
	moveq.l	#0,d1
	move.w	d0,d1
	move.l	d3,a0
	add.l	12(a0),d1
	move.l	d1,a0
	move.l	d3,a1
	move.w	(a1),d0
	add.w	(a0),d0
	move.w	d0,-(sp)
	move.l	d3,a0
	move.w	4(a0),-(sp)
	jsr	_show_sprite_32x32
	lea	16(sp),sp
	bra	L18
	.text
	.globl	_check_attack
_check_attack:
	link	a6,#0
	movem.l	d3/d4/d5/d6,-(sp)
	move.l	12(a6),d6
	move.w	16(a6),d5
	move.l	18(a6),d4
	move.l	8(a6),d3
	move.w	d5,d0
	and.w	#112,d0
	bne	L25
	move.l	d4,a0
	move.w	#0,(a0)
L25:
	move.l	d4,a0
	tst.w	(a0)
	beq	L26
L24:
	movem.l	(sp)+,d3/d4/d5/d6
	unlk	a6
	rts
L26:
	move.w	d5,d0
	and.w	#64,d0
	beq	L27
	move.l	d3,a0
	cmp.w	#64,610(a0)
	bls	L28
	move.w	_mage_anim_def+6,-(sp)
	move.l	d6,-(sp)
	jsr	_set_spr_anim
	addq.w	#6,sp
	move.l	d3,a0
	sub.w	#64,610(a0)
	move.l	d3,a0
	move.l	570(a0),a0
	cmp.w	#10,608(a0)
	bcs	L29
	move.l	d3,a0
	move.l	570(a0),a0
	sub.w	#10,608(a0)
L30:
	move.w	#1,-(sp)
	move.l	d3,a0
	move.l	570(a0),-(sp)
	jsr	_add_plf_lines
	addq.w	#6,sp
	move.l	d3,a0
	move.b	#1,568(a0)
	move.l	d3,a0
	move.b	#1,569(a0)
	move.l	d3,a0
	move.l	570(a0),a0
	move.b	#1,568(a0)
	move.l	d3,a0
	move.l	570(a0),a0
	move.b	#1,569(a0)
L28:
	move.l	d4,a0
	move.w	#1,(a0)
L27:
	move.w	d5,d0
	and.w	#16,d0
	beq	L31
	move.l	d3,a0
	cmp.w	#128,610(a0)
	bls	L32
	move.w	_mage_anim_def+8,-(sp)
	move.l	d6,-(sp)
	jsr	_set_spr_anim
	addq.w	#6,sp
	move.l	d3,a0
	sub.w	#128,610(a0)
	move.l	d3,a0
	move.l	570(a0),a0
	cmp.w	#20,608(a0)
	bcs	L33
	move.l	d3,a0
	move.l	570(a0),a0
	sub.w	#20,608(a0)
L34:
	move.w	#2,-(sp)
	move.l	d3,a0
	move.l	570(a0),-(sp)
	jsr	_add_plf_lines
	addq.w	#6,sp
	move.l	d3,a0
	move.b	#1,568(a0)
	move.l	d3,a0
	move.b	#1,569(a0)
	move.l	d3,a0
	move.l	570(a0),a0
	move.b	#1,568(a0)
	move.l	d3,a0
	move.l	570(a0),a0
	move.b	#1,569(a0)
L32:
	move.l	d4,a0
	move.w	#1,(a0)
L31:
	move.w	d5,d0
	and.w	#32,d0
	beq	L24
	move.l	d3,a0
	cmp.w	#192,610(a0)
	bls	L36
	move.w	_mage_anim_def+10,-(sp)
	move.l	d6,-(sp)
	jsr	_set_spr_anim
	addq.w	#6,sp
	move.l	d3,a0
	sub.w	#192,610(a0)
	move.l	d3,a0
	move.l	570(a0),a0
	cmp.w	#40,608(a0)
	bcs	L37
	move.l	d3,a0
	move.l	570(a0),a0
	sub.w	#40,608(a0)
L38:
	move.l	d3,-(sp)
	jsr	_btl_stone_enm_pieces
	addq.w	#4,sp
	move.l	d3,a0
	move.b	#1,568(a0)
	move.l	d3,a0
	move.b	#1,569(a0)
	move.l	d3,a0
	move.l	570(a0),a0
	move.b	#1,568(a0)
	move.l	d3,a0
	move.l	570(a0),a0
	move.b	#1,569(a0)
L36:
	move.l	d4,a0
	move.w	#1,(a0)
	bra	L24
L37:
	move.l	d3,a0
	move.l	570(a0),a0
	move.w	#0,608(a0)
	bra	L38
L33:
	move.l	d3,a0
	move.l	570(a0),a0
	move.w	#0,608(a0)
	bra	L34
L29:
	move.l	d3,a0
	move.l	570(a0),a0
	move.w	#0,608(a0)
	bra	L30
	.text
	.globl	_do_battle
_do_battle:
	link	a6,#-68
	move.l	d3,-(sp)
	move.l	_curr_plf_opt,a0
	move.w	#10,2(a0)
	move.l	_curr_plf_opt,a0
	move.w	#26,4(a0)
	move.l	_curr_plf_opt,a0
	move.w	#0,6(a0)
	move.l	_curr_plf_opt,a0
	move.w	#0,8(a0)
	move.l	_curr_plf_opt,a0
	move.w	#2,10(a0)
	move.l	_curr_plf_opt,a0
	move.w	#4,12(a0)
	move.l	#_playfield1,-(sp)
	jsr	_init_playfield
	move.l	#_playfield2,(sp)
	jsr	_init_playfield
	addq.w	#4,sp
	move.l	#_playfield2,_playfield1+570
	move.l	#_playfield1,_playfield2+570
	moveq.l	#40,d0
	sub.w	_playfield1+424,d0
	sub.w	_playfield1+422,d0
	move.w	d0,_playfield2+422
	move.w	#14,_plf_display_width
	move.w	#18,_plf_display_height
	jsr	_init_tiles
	move.w	#2048,-(sp)
	move.w	#10240,-(sp)
	move.l	#463360,-(sp)
	jsr	_dma_vram_copy
	addq.w	#8,sp
	move.w	#4,-(sp)
	jsr	_random
	move.w	d0,(sp)
	move.w	#8,-(sp)
	jsr	_random
	move.w	d0,(sp)
	jsr	_draw_fractal_bkg
	move.l	#_playfield1,(sp)
	jsr	_draw_playfield
	move.l	#_playfield2,(sp)
	jsr	_draw_playfield
	addq.w	#4,sp
	moveq.l	#1,d3
L42:
	cmp.w	#81,d3
	beq	L44
	clr.w	-(sp)
	clr.w	-(sp)
	move.w	#-32,-(sp)
	move.w	#-32,-(sp)
	move.w	d3,-(sp)
	jsr	_def_sprite
	lea	10(sp),sp
	addq.w	#1,d3
	bra	L42
L44:
	move.w	#80,-(sp)
	move.w	#1,-(sp)
	jsr	_show_sprite
	move.l	#__mage_s_pal,(sp)
	move.w	#2,-(sp)
	jsr	_set_colors
	addq.w	#6,sp
	move.l	#__mage_s_pal,-(sp)
	move.w	#3,-(sp)
	jsr	_set_colors
	addq.w	#6,sp
	pea	-32(a6)
	move.l	#_mage_anim_def,-(sp)
	clr.w	-(sp)
	move.l	#_mage_anim,-(sp)
	move.w	#384,-(sp)
	move.l	#757472,-(sp)
	move.w	#112,-(sp)
	move.w	_playfield1+422,d0
	add.w	_playfield1+424,d0
	addq.w	#2,d0
	lsl.w	#3,d0
	move.w	d0,-(sp)
	move.w	#17,-(sp)
	jsr	_init_spr_anim
	lea	26(sp),sp
	pea	-64(a6)
	move.l	#_mage_anim_def,-(sp)
	move.w	#1,-(sp)
	move.l	#_mage_anim,-(sp)
	move.w	#400,-(sp)
	move.l	#757472,-(sp)
	move.w	#112,-(sp)
	move.w	_playfield2+422,d0
	subq.w	#6,d0
	lsl.w	#3,d0
	move.w	d0,-(sp)
	move.w	#18,-(sp)
	jsr	_init_spr_anim
	lea	26(sp),sp
	lea	-64(a6),a0
	move.l	a0,-6(a6)
	lea	-32(a6),a0
	move.l	a0,-38(a6)
	jsr	_init_joypad
	move.w	#0,-66(a6)
	move.w	#0,-68(a6)
	move.l	#L45,-(sp)
	move.w	#49152,-(sp)
	move.w	#1,-(sp)
	clr.w	-(sp)
	clr.w	-(sp)
	jsr	_out_text
	lea	12(sp),sp
L46:
	cmp.w	#1,_playfield1+566
	bne	L48
	cmp.w	#1,_playfield2+566
	beq	L47
L48:
	jsr	_test_joy
	jsr	_read_joypad1
	move.w	d0,-(sp)
	move.l	#_playfield1,-(sp)
	jsr	_handle_playfield
	addq.w	#6,sp
	jsr	_read_joypad2
	move.w	d0,-(sp)
	move.l	#_playfield2,-(sp)
	jsr	_handle_playfield
	addq.w	#6,sp
	jsr	_generate_sound
	jsr	_wait_sync
	move.l	#_playfield1,-(sp)
	jsr	_draw_playfield
	move.l	#_playfield1,(sp)
	jsr	_draw_battle_playfield_frame
	move.b	#0,_playfield1+568
	move.b	#0,_playfield1+569
	move.l	#_playfield2,(sp)
	jsr	_draw_playfield
	move.l	#_playfield2,(sp)
	jsr	_draw_battle_playfield_frame
	addq.w	#4,sp
	move.b	#0,_playfield2+568
	move.b	#0,_playfield2+569
	pea	-32(a6)
	jsr	_handle_spr_anim
	addq.w	#4,sp
	pea	-64(a6)
	jsr	_handle_spr_anim
	addq.w	#4,sp
	move.w	#18,-(sp)
	move.w	#1,-(sp)
	jsr	_show_sprite
	addq.w	#4,sp
	jsr	_read_joypad1
	move.w	d0,-(sp)
	jsr	_read_joypad2
	or.w	(sp)+,d0
	and.w	#128,d0
	beq	L49
	jsr	_pause_menu
	cmp.w	#1,d0
	bne	L49
	move.w	#28672,_playfield1+514
	move.l	#_playfield1,-(sp)
	jsr	_prepare_gameover
	move.w	#28672,_playfield2+514
	move.l	#_playfield2,(sp)
	jsr	_prepare_gameover
	addq.w	#4,sp
L49:
	pea	-66(a6)
	jsr	_read_joypad1
	move.w	d0,-(sp)
	pea	-32(a6)
	move.l	#_playfield1,-(sp)
	jsr	_check_attack
	lea	14(sp),sp
	pea	-68(a6)
	jsr	_read_joypad2
	move.w	d0,-(sp)
	pea	-64(a6)
	move.l	#_playfield2,-(sp)
	jsr	_check_attack
	lea	14(sp),sp
	bra	L46
L47:
	moveq.l	#1,d3
L51:
	cmp.w	#81,d3
	beq	L53
	clr.w	-(sp)
	clr.w	-(sp)
	move.w	#-32,-(sp)
	move.w	#-32,-(sp)
	move.w	d3,-(sp)
	jsr	_def_sprite
	lea	10(sp),sp
	addq.w	#1,d3
	bra	L51
L53:
	move.w	#80,-(sp)
	move.w	#1,-(sp)
	jsr	_show_sprite
	addq.w	#4,sp
	move.l	(sp)+,d3
	unlk	a6
	rts
	.text
	.globl	_test_battle
_test_battle:
	link	a6,#-64
	movem.l	d3-d4,-(sp)
	jsr	_init_tiles
	move.l	#__mage_s_pal,-(sp)
	move.w	#2,-(sp)
	jsr	_set_colors
	addq.w	#6,sp
	move.l	#__mage_s_pal,-(sp)
	move.w	#3,-(sp)
	jsr	_set_colors
	addq.w	#6,sp
	pea	-32(a6)
	move.l	#_mage_anim_def,-(sp)
	clr.w	-(sp)
	move.l	#_mage_anim,-(sp)
	move.w	#384,-(sp)
	move.l	#757472,-(sp)
	move.w	#32,-(sp)
	move.w	#32,-(sp)
	move.w	#1,-(sp)
	jsr	_init_spr_anim
	lea	26(sp),sp
	pea	-64(a6)
	move.l	#_mage_anim_def,-(sp)
	move.w	#1,-(sp)
	move.l	#_mage_anim,-(sp)
	move.w	#400,-(sp)
	move.l	#757472,-(sp)
	move.w	#32,-(sp)
	move.w	#128,-(sp)
	move.w	#2,-(sp)
	jsr	_init_spr_anim
	lea	26(sp),sp
	lea	-64(a6),a0
	move.l	a0,-6(a6)
	lea	-32(a6),a0
	move.l	a0,-38(a6)
L57:
	jsr	_read_joypad1
	and.w	#128,d0
	bne	L62
	pea	-32(a6)
	jsr	_handle_spr_anim
	addq.w	#4,sp
	pea	-64(a6)
	jsr	_handle_spr_anim
	addq.w	#4,sp
	move.w	#2,-(sp)
	move.w	#1,-(sp)
	jsr	_show_sprite
	addq.w	#4,sp
	jsr	_wait_sync
	jsr	_read_joypad1
	move.w	d0,d3
	and.w	#64,d0
	beq	L59
	move.w	_mage_anim_def+6,-(sp)
	pea	-32(a6)
	jsr	_set_spr_anim
	addq.w	#6,sp
L59:
	move.w	d3,d0
	and.w	#16,d0
	beq	L60
	move.w	_mage_anim_def+8,-(sp)
	pea	-32(a6)
	jsr	_set_spr_anim
	addq.w	#6,sp
L60:
	move.w	d3,d0
	and.w	#32,d0
	beq	L57
	move.w	_mage_anim_def+10,-(sp)
	pea	-32(a6)
	jsr	_set_spr_anim
	addq.w	#6,sp
	bra	L57
L62:
	jsr	_read_joypad1
	and.w	#128,d0
	bne	L62
	moveq.l	#1,d3
L64:
	cmp.w	#81,d3
	beq	L66
	clr.w	-(sp)
	clr.w	-(sp)
	move.w	#-32,-(sp)
	move.w	#-32,-(sp)
	move.w	d3,-(sp)
	jsr	_def_sprite
	lea	10(sp),sp
	addq.w	#1,d3
	bra	L64
L66:
	move.w	#80,-(sp)
	move.w	#1,-(sp)
	jsr	_show_sprite
	addq.w	#4,sp
	movem.l	(sp)+,d3-d4
	unlk	a6
	rts
	.data
L45:	.dc.b	$55,$6c,$74,$69,$6d,$61,$74,$65,$20,$74,$65
	.dc.b	$74,$72,$69,$73,$20,$62,$65,$74,$61,$20,$76,$65,$72,$73,$69,$6f
	.dc.b	$6e
	.dc.b	0
	.text
	.globl	_play_battle_mode
_play_battle_mode:
	link	a6,#0
	jsr	_do_battle
	unlk	a6
	rts
