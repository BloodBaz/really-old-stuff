	.data
	.globl	_pieces
_pieces:
	.dc.b	0
	.dc.b	0
	.dc.b	0
	.dc.b	0
	.dc.b	0
	.dc.b	1
	.dc.b	1
	.dc.b	0
	.dc.b	0
	.dc.b	1
	.dc.b	1
	.dc.b	0
	.dc.b	0
	.dc.b	0
	.dc.b	0
	.dc.b	0
	.dc.b	0
	.dc.b	0
	.dc.b	0
	.dc.b	0
	.dc.b	0
	.dc.b	0
	.dc.b	1
	.dc.b	0
	.dc.b	0
	.dc.b	1
	.dc.b	1
	.dc.b	0
	.dc.b	0
	.dc.b	1
	.dc.b	0
	.dc.b	0
	.dc.b	0
	.dc.b	0
	.dc.b	0
	.dc.b	0
	.dc.b	0
	.dc.b	1
	.dc.b	0
	.dc.b	0
	.dc.b	0
	.dc.b	1
	.dc.b	1
	.dc.b	0
	.dc.b	0
	.dc.b	0
	.dc.b	1
	.dc.b	0
	.dc.b	0
	.dc.b	0
	.dc.b	0
	.dc.b	0
	.dc.b	0
	.dc.b	1
	.dc.b	1
	.dc.b	0
	.dc.b	0
	.dc.b	0
	.dc.b	1
	.dc.b	0
	.dc.b	0
	.dc.b	0
	.dc.b	1
	.dc.b	0
	.dc.b	0
	.dc.b	0
	.dc.b	0
	.dc.b	0
	.dc.b	0
	.dc.b	1
	.dc.b	1
	.dc.b	0
	.dc.b	0
	.dc.b	1
	.dc.b	0
	.dc.b	0
	.dc.b	0
	.dc.b	1
	.dc.b	0
	.dc.b	0
	.dc.b	0
	.dc.b	0
	.dc.b	1
	.dc.b	0
	.dc.b	0
	.dc.b	0
	.dc.b	1
	.dc.b	0
	.dc.b	0
	.dc.b	0
	.dc.b	1
	.dc.b	0
	.dc.b	0
	.dc.b	0
	.dc.b	1
	.dc.b	0
	.dc.b	0
	.dc.b	0
	.dc.b	1
	.dc.b	0
	.dc.b	0
	.dc.b	1
	.dc.b	1
	.dc.b	0
	.dc.b	0
	.dc.b	0
	.dc.b	1
	.dc.b	0
	.dc.b	0
	.dc.b	0
	.dc.b	0
	.dc.b	0
	.dc.b	0
	.dc.b	1
	.dc.b	1
	.dc.b	0
	.dc.b	0
	.dc.b	0
	.dc.b	1
	.dc.b	0
	.dc.b	0
	.dc.b	0
	.dc.b	1
	.dc.b	0
	.dc.b	0
	.dc.b	0
	.dc.b	1
	.dc.b	0
	.dc.b	0
	.dc.b	1
	.dc.b	1
	.dc.b	0
	.dc.b	0
	.dc.b	1
	.dc.b	0
	.dc.b	0
	.dc.b	0
	.dc.b	1
	.dc.b	0
	.dc.b	0
	.dc.b	0
	.dc.b	1
	.dc.b	0
	.dc.b	0
	.dc.b	0
	.dc.b	1
	.dc.b	0
	.dc.b	0
	.dc.b	0
	.dc.b	1
	.dc.b	1
	.dc.b	0
	.dc.b	0
	.dc.b	0
	.dc.b	1
	.dc.b	0
	.dc.b	0
	.dc.b	0
	.dc.b	1
	.dc.b	0
	.dc.b	0
	.dc.b	0
	.dc.b	1
	.dc.b	0
	.dc.b	0
	.dc.b	1
	.dc.b	1
	.dc.b	0
	.dc.b	0
	.dc.b	1
	.dc.b	0
	.dc.b	0
	.dc.b	0
	.dc.b	1
	.dc.b	0
	.dc.b	0
	.dc.b	0
	.dc.b	0
	.dc.b	0
	.dc.b	0
	.dc.b	0
	.dc.b	1
	.dc.b	1
	.dc.b	1
	.dc.b	0
	.dc.b	1
	.dc.b	0
	.dc.b	1
	.dc.b	0
	.dc.b	0
	.dc.b	0
	.dc.b	0
	.dc.b	0
	.dc.b	0
	.dc.b	0
	.dc.b	0
	.dc.b	0
	.dc.b	1
	.dc.b	1
	.dc.b	1
	.dc.b	0
	.dc.b	1
	.dc.b	1
	.dc.b	0
	.dc.b	0
	.dc.b	0
	.dc.b	0
	.dc.b	0
	.dc.b	0
	.dc.b	0
	.dc.b	1
	.dc.b	0
	.dc.b	0
	.dc.b	1
	.dc.b	1
	.dc.b	1
	.dc.b	0
	.dc.b	0
	.dc.b	1
	.dc.b	0
	.dc.b	0
	.dc.b	0
	.dc.b	0
	.dc.b	0
	.globl	_speed_table
_speed_table:
	.dc.w	45
	.dc.w	40
	.dc.w	33
	.dc.w	20
	.dc.w	14
	.dc.w	10
	.dc.w	8
	.dc.w	6
	.dc.w	4
	.dc.w	2
	.text
	.globl	_new_piece
_new_piece:
	link	a6,#0
	movem.l	d3/d4/d5/d6/d7,-(sp)
	move.l	8(a6),d7
	moveq.l	#0,d3
L3:
	cmp.w	#4,d3
	beq	L5
	moveq.l	#0,d4
L6:
	cmp.w	#4,d4
	beq	L4
	move.w	d3,d0
	lsl.w	#2,d0
	moveq.l	#0,d1
	move.w	d0,d1
	move.l	d7,a0
	lea	448(a0),a0
	add.l	d1,a0
	moveq.l	#0,d0
	move.w	d4,d0
	add.l	d0,a0
	move.w	d3,d0
	lsl.w	#2,d0
	moveq.l	#0,d1
	move.w	d0,d1
	move.l	d7,a1
	lea	428(a1),a1
	add.l	d1,a1
	moveq.l	#0,d0
	move.w	d4,d0
	add.l	d0,a1
	move.b	(a0),(a1)
	addq.w	#1,d4
	bra	L6
L4:
	addq.w	#1,d3
	bra	L3
L5:
	moveq.l	#0,d5
L9:
	cmp.w	#3,d5
	beq	L11
	moveq.l	#0,d3
L12:
	cmp.w	#4,d3
	beq	L10
	moveq.l	#0,d4
L15:
	cmp.w	#4,d4
	beq	L13
	move.w	d5,d0
	addq.w	#1,d0
	lsl.w	#4,d0
	moveq.l	#0,d1
	move.w	d0,d1
	move.l	d7,a0
	lea	448(a0),a0
	add.l	d1,a0
	move.w	d3,d0
	lsl.w	#2,d0
	moveq.l	#0,d1
	move.w	d0,d1
	add.l	d1,a0
	moveq.l	#0,d0
	move.w	d4,d0
	add.l	d0,a0
	move.b	(a0),-(sp)
	move.w	d5,d0
	lsl.w	#4,d0
	moveq.l	#0,d1
	move.w	d0,d1
	move.l	d7,a0
	lea	448(a0),a0
	add.l	d1,a0
	move.w	d3,d0
	lsl.w	#2,d0
	moveq.l	#0,d1
	move.w	d0,d1
	add.l	d1,a0
	moveq.l	#0,d0
	move.w	d4,d0
	add.l	d0,a0
	move.b	(sp)+,(a0)
	addq.w	#1,d4
	bra	L15
L13:
	addq.w	#1,d3
	bra	L12
L10:
	addq.w	#1,d5
	bra	L9
L11:
	move.l	d7,a0
	tst.b	559(a0)
	beq	L18
	move.w	#13,-(sp)
	jsr	_random
	addq.w	#2,sp
	move.w	d0,d5
L19:
	move.w	#4,-(sp)
	jsr	_random
	addq.w	#2,sp
	addq.w	#2,d0
	move.w	d0,d6
	moveq.l	#0,d3
L20:
	cmp.w	#4,d3
	beq	L22
	moveq.l	#0,d4
L23:
	cmp.w	#4,d4
	beq	L21
	move.w	d5,d0
	lsl.w	#4,d0
	moveq.l	#0,d1
	move.w	d0,d1
	add.l	#_pieces,d1
	move.l	d1,a0
	move.w	d3,d0
	lsl.w	#2,d0
	moveq.l	#0,d1
	move.w	d0,d1
	add.l	d1,a0
	moveq.l	#0,d0
	move.w	d4,d0
	add.l	d0,a0
	tst.b	(a0)
	beq	L26
	move.l	d7,a0
	tst.b	558(a0)
	beq	L27
	move.w	#15,-(sp)
	jsr	_random
	addq.w	#2,sp
	tst.w	d0
	bne	L27
	move.w	d3,d0
	lsl.w	#2,d0
	moveq.l	#0,d1
	move.w	d0,d1
	move.l	d7,a0
	lea	496(a0),a0
	add.l	d1,a0
	moveq.l	#0,d0
	move.w	d4,d0
	add.l	d0,a0
	move.b	#8,(a0)
L24:
	addq.w	#1,d4
	bra	L23
L27:
	move.w	d3,d0
	lsl.w	#2,d0
	moveq.l	#0,d1
	move.w	d0,d1
	move.l	d7,a0
	lea	496(a0),a0
	add.l	d1,a0
	moveq.l	#0,d0
	move.w	d4,d0
	add.l	d0,a0
	move.b	d6,(a0)
	bra	L24
L26:
	move.w	d3,d0
	lsl.w	#2,d0
	moveq.l	#0,d1
	move.w	d0,d1
	move.l	d7,a0
	lea	496(a0),a0
	add.l	d1,a0
	moveq.l	#0,d0
	move.w	d4,d0
	add.l	d0,a0
	move.b	#0,(a0)
	bra	L24
L21:
	addq.w	#1,d3
	bra	L20
L22:
	move.l	d7,a0
	move.w	#-4,514(a0)
	move.l	d7,-(sp)
	jsr	_update_piece_w
	addq.w	#4,sp
	move.l	d7,a0
	move.b	#1,568(a0)
	movem.l	(sp)+,d3/d4/d5/d6/d7
	unlk	a6
	rts
L18:
	move.w	#7,-(sp)
	jsr	_random
	addq.w	#2,sp
	move.w	d0,d5
	bra	L19
	.data
	.text
	.globl	_handle_playfield
_handle_playfield:
	link	a6,#0
	movem.l	d3/d4/d5/d6/d7,-(sp)
	move.w	12(a6),d7
	move.l	8(a6),d6
	move.l	d6,a0
	cmp.w	#1,566(a0)
	bne	L33
L34:
	move.l	d6,a0
	addq.w	#1,524(a0)
	movem.l	(sp)+,d3/d4/d5/d6/d7
	unlk	a6
	rts
L33:
	move.l	d6,a0
	tst.w	566(a0)
	beq	L35
	move.l	d6,-(sp)
	jsr	_gameover_sequence
	addq.w	#4,sp
	bra	L34
L35:
	move.l	d6,a0
	tst.w	530(a0)
	beq	L37
	move.l	d6,-(sp)
	jsr	_clear_lines
	addq.w	#4,sp
	bra	L34
L37:
	move.l	d6,a0
	cmp.w	#28672,514(a0)
	bne	L39
	move.l	d6,-(sp)
	jsr	_new_piece
	addq.w	#4,sp
	bra	L34
L39:
	move.w	d7,d0
	and.w	#4,d0
	beq	L41
	move.l	d6,a0
	cmp.w	#-2,512(a0)
	beq	L41
	move.l	d6,a0
	tst.w	526(a0)
	beq	L44
	move.l	d6,a0
	move.w	528(a0),d0
	and.w	#4,d0
	bne	L41
L44:
	move.l	d6,a0
	move.l	d6,a1
	move.w	516(a0),512(a1)
	move.w	#-1,-(sp)
	move.l	d6,-(sp)
	jsr	_move_piece_lr
	addq.w	#6,sp
L41:
	move.w	d7,d0
	and.w	#8,d0
	beq	L45
	move.l	d6,a0
	move.l	d6,a1
	move.w	424(a1),d0
	subq.w	#2,d0
	move.w	512(a0),d1
	cmp.w	d0,d1
	beq	L45
	move.l	d6,a0
	tst.w	526(a0)
	beq	L48
	move.l	d6,a0
	move.w	528(a0),d0
	and.w	#8,d0
	bne	L45
L48:
	move.l	d6,a0
	move.l	d6,a1
	move.w	516(a0),512(a1)
	move.w	#1,-(sp)
	move.l	d6,-(sp)
	jsr	_move_piece_lr
	addq.w	#6,sp
L45:
	move.w	d7,d0
	and.w	#1,d0
	beq	L49
	move.l	d6,a0
	move.w	528(a0),d0
	and.w	#1,d0
	bne	L49
	move.l	d6,-(sp)
	jsr	_rotate_piece
	addq.w	#4,sp
L49:
	move.w	d7,d0
	and.w	#2,d0
	beq	L50
	move.l	d6,a0
	move.w	524(a0),d0
	and.w	#1,d0
	bne	L50
	move.l	d6,-(sp)
	jsr	_lower_piece
	addq.w	#4,sp
L50:
	move.w	d7,d0
	and.w	#128,d0
	beq	L52
L52:
	move.l	d6,a0
	move.w	d7,528(a0)
	move.l	d6,-(sp)
	jsr	_update_pcs
	addq.w	#4,sp
	move.l	d6,a0
	tst.w	520(a0)
	bne	L53
	move.l	d6,-(sp)
	jsr	_lower_piece
	addq.w	#4,sp
	move.l	d6,a0
	move.l	d6,a1
	move.w	522(a0),520(a1)
L54:
	move.w	d7,d0
	and.w	#12,d0
	bne	L55
	move.l	d6,a0
	move.w	#4,526(a0)
L56:
	move.l	d6,a0
	tst.w	530(a0)
	beq	L34
	move.l	d6,a0
	move.w	530(a0),d0
	beq	L59
	cmp.w	#1,d0
	beq	L62
	cmp.w	#2,d0
	beq	L63
	cmp.w	#3,d0
	beq	L70
	cmp.w	#4,d0
	beq	L77
L59:
	move.l	d6,a0
	cmp.w	#255,610(a0)
	bls	L79
	move.l	d6,a0
	move.w	#255,610(a0)
L79:
	move.l	d6,a0
	tst.l	570(a0)
	beq	L80
	move.l	d6,a0
	move.l	570(a0),a0
	tst.w	566(a0)
	bne	L80
	move.l	d6,a0
	cmp.w	#1,530(a0)
	bls	L80
	cmp.w	#4,_curr_game_mode
	beq	L80
	move.l	d6,a0
	move.w	530(a0),d0
	subq.w	#1,d0
	move.w	d0,-(sp)
	move.l	d6,a0
	move.l	570(a0),-(sp)
	jsr	_add_plf_lines
	addq.w	#6,sp
L80:
	move.l	d6,a0
	move.l	d6,a1
	move.w	530(a0),d0
	add.w	d0,532(a1)
	move.l	d6,a0
	tst.w	530(a0)
	beq	L81
	move.l	d6,a0
	move.w	530(a0),d3
	move.w	d3,d0
	subq.w	#1,d0
	lsl.w	#1,d0
	moveq.l	#0,d1
	move.w	d0,d1
	move.l	d6,a0
	lea	534(a0),a0
	add.l	d1,a0
	addq.w	#1,(a0)
L82:
	tst.w	d3
	beq	L83
	move.w	d3,d0
	subq.w	#1,d0
	lsl.w	#1,d0
	moveq.l	#0,d1
	move.w	d0,d1
	move.l	d6,a0
	lea	542(a0),a0
	add.l	d1,a0
	tst.w	(a0)
	bne	L83
	subq.w	#1,d3
	bra	L82
L83:
	tst.w	d3
	beq	L84
	move.w	d3,d0
	subq.w	#1,d0
	lsl.w	#1,d0
	moveq.l	#0,d1
	move.w	d0,d1
	move.l	d6,a0
	lea	542(a0),a0
	add.l	d1,a0
	subq.w	#1,(a0)
L84:
	move.l	d6,-(sp)
	jsr	_count_special_blocks
	move.l	d6,a0
	move.w	d0,562(a0)
	move.l	d6,(sp)
	jsr	_check_plf_meta
	addq.w	#4,sp
	move.l	d6,a0
	move.w	d0,564(a0)
L81:
	move.l	d6,a0
	moveq.l	#0,d0
	move.w	532(a0),d0
	divu	#20,d0
	move.l	d6,a0
	add.w	552(a0),d0
	move.w	d0,d3
	cmp.w	#10,d3
	bcc	L85
	move.l	d6,a0
	move.w	d3,550(a0)
	move.w	d3,d0
	lsl.w	#1,d0
	moveq.l	#0,d1
	move.w	d0,d1
	add.l	#_speed_table,d1
	move.l	d1,a0
	move.w	(a0),d3
L86:
	move.l	d6,a0
	cmp.w	522(a0),d3
	beq	L34
	move.l	d6,a0
	move.w	d3,522(a0)
	move.l	#_TanTanTaan1,-(sp)
	move.w	#1,-(sp)
	jsr	_start_sound
	addq.w	#6,sp
	bra	L34
L85:
	move.l	d6,a0
	move.w	#9,550(a0)
	moveq.l	#0,d3
	bra	L86
L77:
	move.l	d6,a0
	add.l	#1300,554(a0)
	move.l	d6,a0
	add.w	#192,610(a0)
	move.l	#17936,-(sp)
	move.l	#812694,-(sp)
	jsr	_play_sample
	addq.w	#8,sp
	bra	L59
L70:
	move.l	d6,a0
	add.l	#400,554(a0)
	move.l	d6,a0
	add.w	#128,610(a0)
	tst.w	_curr_language
	beq	L73
	move.l	#803086,d0
L74:
	tst.w	_curr_language
	beq	L75
	move.l	#792930,d1
L76:
	sub.l	d1,d0
	move.l	d0,-(sp)
	tst.w	_curr_language
	beq	L71
	move.l	#792930,d0
L72:
	move.l	d0,-(sp)
	jsr	_play_sample
	addq.w	#8,sp
	bra	L59
L71:
	move.l	#803086,d0
	bra	L72
L75:
	move.l	#803086,d1
	bra	L76
L73:
	move.l	#812694,d0
	bra	L74
L63:
	move.l	d6,a0
	add.l	#150,554(a0)
	move.l	d6,a0
	add.w	#72,610(a0)
	tst.w	_curr_language
	beq	L66
	move.l	#782792,d0
L67:
	tst.w	_curr_language
	beq	L68
	move.l	#773265,d1
L69:
	sub.l	d1,d0
	move.l	d0,-(sp)
	tst.w	_curr_language
	beq	L64
	move.l	#773265,d0
L65:
	move.l	d0,-(sp)
	jsr	_play_sample
	addq.w	#8,sp
	bra	L59
L64:
	move.l	#782792,d0
	bra	L65
L68:
	move.l	#782792,d1
	bra	L69
L66:
	move.l	#792930,d0
	bra	L67
L62:
	move.l	d6,a0
	add.l	#50,554(a0)
	move.l	d6,a0
	add.w	#32,610(a0)
	move.l	#8113,-(sp)
	move.l	#765152,-(sp)
	jsr	_play_sample
	addq.w	#8,sp
	bra	L59
L55:
	move.l	d6,a0
	tst.w	526(a0)
	beq	L56
	move.l	d6,a0
	subq.w	#1,526(a0)
	bra	L56
L53:
	move.l	d6,a0
	subq.w	#1,520(a0)
	bra	L54
