	.data
	.globl	_bkg_pal
_bkg_pal:
	.dc.w	0
	.dc.w	2560
	.dc.w	160
	.dc.w	2720
	.dc.w	10
	.dc.w	2570
	.dc.w	170
	.dc.w	2730
	.dc.w	2184
	.dc.w	3720
	.dc.w	2280
	.dc.w	3816
	.dc.w	2190
	.dc.w	3726
	.dc.w	2286
	.dc.w	3822
	.globl	_saucer_pal
_saucer_pal:
	.dc.w	0
	.dc.w	2
	.dc.w	6
	.dc.w	8
	.dc.w	10
	.dc.w	14
	.dc.w	34
	.dc.w	102
	.dc.w	136
	.dc.w	170
	.dc.w	238
	.dc.w	546
	.dc.w	1638
	.dc.w	2184
	.dc.w	2730
	.dc.w	3822
	.globl	_alt_pal
_alt_pal:
	.dc.w	0
	.dc.w	68
	.dc.w	136
	.dc.w	238
	.dc.w	1088
	.dc.w	2176
	.dc.w	3808
	.dc.w	1028
	.dc.w	2056
	.dc.w	3598
	.dc.w	2286
	.dc.w	2798
	.dc.w	34
	.dc.w	1126
	.dc.w	2218
	.dc.w	3310
	.globl	_player_pal
_player_pal:
	.dc.w	0
	.dc.w	512
	.dc.w	1536
	.dc.w	2048
	.dc.w	2560
	.dc.w	3584
	.dc.w	34
	.dc.w	102
	.dc.w	136
	.dc.w	170
	.dc.w	238
	.dc.w	546
	.dc.w	1638
	.dc.w	2184
	.dc.w	2730
	.dc.w	3822
	.globl	_vortex_pal
_vortex_pal:
	.dc.w	0
	.dc.w	512
	.dc.w	544
	.dc.w	1056
	.dc.w	1088
	.dc.w	1600
	.dc.w	1634
	.dc.w	2146
	.dc.w	2178
	.dc.w	2694
	.dc.w	2726
	.dc.w	3238
	.dc.w	3274
	.dc.w	3786
	.dc.w	3818
	.dc.w	3822
	.globl	_skull_pal
_skull_pal:
	.dc.w	0
	.dc.w	32
	.dc.w	64
	.dc.w	96
	.dc.w	128
	.dc.w	160
	.dc.w	192
	.dc.w	224
	.dc.w	642
	.dc.w	1188
	.dc.w	1734
	.dc.w	738
	.dc.w	1252
	.dc.w	1766
	.dc.w	2280
	.dc.w	2794
	.globl	_shot2
_shot2:
	.dc.w	5470
	.dc.w	10250
	.dc.w	5420
	.dc.w	5370
	.dc.w	5320
	.dc.w	5390
	.dc.w	5470
	.dc.w	5560
	.dc.w	5580
	.dc.w	5600
	.dc.w	5620
	.dc.w	5640
	.dc.w	5660
	.dc.w	10240
	.dc.w	0
	.globl	_taunts
_taunts:
	.dc.b	$4c,$41,$53,$54,$46,$4f,$52,$4c,$2e,$53,$4e
	.dc.b	$44
	.dc.b	0
	.ds.b	1
	.dc.b	$4e,$4f,$43,$48,$41,$4e,$43,$45,$2e,$53,$4e
	.dc.b	$44
	.dc.b	0
	.ds.b	1
	.dc.b	$50,$52,$45,$50,$44,$49,$45,$2e,$53,$4e,$44
	.dc.b	0
	.ds.b	2
	.dc.b	$52,$45,$41,$4c,$48,$4f,$54,$2e,$53,$4e,$44
	.dc.b	0
	.ds.b	2
	.dc.b	$54,$48,$4e,$4b,$44,$45,$46,$54,$2e,$53,$4e
	.dc.b	$44
	.dc.b	0
	.ds.b	1
	.globl	_praise
_praise:
	.dc.b	$42,$45,$54,$54,$45,$52,$2e,$53,$4e,$44
	.dc.b	0
	.ds.b	3
	.dc.b	$49,$4d,$50,$52,$45,$53,$53,$2e,$53,$4e,$44
	.dc.b	0
	.ds.b	2
	.dc.b	$4e,$4f,$54,$42,$41,$44,$2e,$53,$4e,$44
	.dc.b	0
	.ds.b	3
	.globl	_gameover
_gameover:
	.dc.l	L0
	.dc.l	L1
	.dc.l	L2
	.bss
	.globl	_shot_dly
	.comm	_shot_dly,2
	.globl	_tgt_angle
	.comm	_tgt_angle,2
	.globl	_cur_angle
	.comm	_cur_angle,2
	.globl	_player
	.comm	_player,4
	.globl	_gem_count
	.comm	_gem_count,2
	.globl	_lives
	.comm	_lives,2
	.globl	_level
	.comm	_level,2
	.globl	_player_dead
	.comm	_player_dead,2
	.globl	_score
	.comm	_score,4
	.text
	.globl	_main
_main:
	link	a6,#-10
	movem.l	d3-d5,-(sp)
	jsr	_init_GFX
	jsr	_RAZ
	jsr	_wait_sync
	jsr	_init_GFS
	jsr	_init_joypad
	move.l	#L6,-(sp)
	pea	-8(a6)
	jsr	_get_GFS_fileaddr
	addq.w	#8,sp
	clr.w	-(sp)
	move.w	#15,-(sp)
	move.w	#256,-(sp)
	clr.w	-(sp)
	move.l	-8(a6),-(sp)
	jsr	_loadfont
	lea	12(sp),sp
	jsr	_init_text_mode
	move.l	#_actor_sprites,_player
L7:
	jsr	_clrscr
	clr.w	-(sp)
	clr.w	-(sp)
	jsr	_scrollv
	addq.w	#4,sp
	clr.w	-(sp)
	clr.w	-(sp)
	jsr	_scrollh
	addq.w	#4,sp
	jsr	_sprite_prepare
	move.w	#80,-(sp)
	move.w	#1,-(sp)
	jsr	_show_sprite
	addq.w	#4,sp
	move.w	#3,_lives
	move.w	#1,_level
	move.l	#0,_score
L9:
	tst.w	_lives
	beq	L7
	jsr	_play_level
	bra	L9
	.text
	.globl	_play_level
_play_level:
	link	a6,#-6
	movem.l	d3/d4,-(sp)
	jsr	_clrscr
	move.w	#16,-(sp)
	move.w	#240,-(sp)
	move.l	#L14,-(sp)
	jsr	_tileset_load_RDC
	addq.w	#8,sp
	move.w	#144,-(sp)
	move.w	#256,-(sp)
	move.l	#L15,-(sp)
	jsr	_tileset_load_RDC
	addq.w	#8,sp
	move.w	#64,-(sp)
	move.w	#400,-(sp)
	move.l	#L16,-(sp)
	jsr	_tileset_load_RDC
	addq.w	#8,sp
	move.w	#64,-(sp)
	move.w	#512,-(sp)
	move.l	#L17,-(sp)
	jsr	_tileset_load_RDC
	addq.w	#8,sp
	move.w	#64,-(sp)
	move.w	#576,-(sp)
	move.l	#L18,-(sp)
	jsr	_tileset_load_RDC
	addq.w	#8,sp
	move.w	#64,-(sp)
	move.w	#640,-(sp)
	move.l	#L19,-(sp)
	jsr	_tileset_load_RDC
	addq.w	#8,sp
	move.w	#64,-(sp)
	move.w	#704,-(sp)
	move.l	#L20,-(sp)
	jsr	_tileset_load_RDC
	addq.w	#8,sp
	move.w	#256,-(sp)
	move.w	#768,-(sp)
	move.l	#L21,-(sp)
	jsr	_tileset_load_RDC
	addq.w	#8,sp
	move.w	#64,-(sp)
	move.w	#1024,-(sp)
	move.l	#L22,-(sp)
	jsr	_tileset_load_RDC
	addq.w	#8,sp
	move.l	#_bkg_pal,-(sp)
	clr.w	-(sp)
	jsr	_set_colors
	addq.w	#6,sp
	move.l	#_player_pal,-(sp)
	move.w	#1,-(sp)
	jsr	_set_colors
	addq.w	#6,sp
	move.l	#_saucer_pal,-(sp)
	move.w	#2,-(sp)
	jsr	_set_colors
	addq.w	#6,sp
	move.l	#_vortex_pal,-(sp)
	move.w	#3,-(sp)
	jsr	_set_colors
	addq.w	#6,sp
	move.w	#1,_saucers_cnt
L23:
	tst.w	_lives
	beq	L24
	tst.w	_saucers_cnt
	beq	L24
	move.w	#9,-(sp)
	move.w	#8448,-(sp)
	move.w	#2560,-(sp)
	move.w	#192,-(sp)
	move.w	#144,-(sp)
	move.w	#1,-(sp)
	move.l	#_actor_sprites,-(sp)
	jsr	_sprite_init
	lea	16(sp),sp
	move.w	#16,_actor_sprites+20
	move.w	#255,_actor_sprites+18
	move.w	#63,_actor_sprites+26
	move.w	#63,_actor_sprites+36
	move.w	#1536,_actor_sprites+30
	move.w	#1536,_actor_sprites+40
	jsr	_ai_reset
	jsr	_shot_reset
	move.w	#0,_shot_dly
	move.w	#0,_actor_map_x
	move.w	#0,_actor_map_y
	move.w	#0,_tgt_angle
	move.w	#0,_cur_angle
	move.w	#1,-2(a6)
L25:
	cmp.w	#40,-2(a6)
	beq	L27
	clr.w	-(sp)
	clr.w	-(sp)
	clr.w	-(sp)
	move.w	#-32,-(sp)
	move.w	#-32,-(sp)
	clr.w	-(sp)
	moveq.l	#42,d0
	mulu	-2(a6),d0
	moveq.l	#0,d1
	move.w	d0,d1
	add.l	#_actor_sprites,d1
	move.l	d1,a0
	pea	(a0)
	jsr	_sprite_init
	lea	16(sp),sp
	addq.w	#1,-2(a6)
	bra	L25
L27:
	move.l	#_skull_pal,-(sp)
	move.w	#2,-(sp)
	jsr	_set_colors
	addq.w	#6,sp
	move.w	#16,-(sp)
	move.w	#25344,-(sp)
	move.w	#3840,-(sp)
	move.w	#72,-(sp)
	move.w	#144,-(sp)
	move.w	#36,-(sp)
	move.l	#_actor_sprites+1470,-(sp)
	jsr	_sprite_init
	lea	16(sp),sp
	move.w	#16,_actor_sprites+1490
	move.w	#255,_actor_sprites+1488
	move.w	#16,-(sp)
	move.w	#17408,-(sp)
	move.w	#3840,-(sp)
	move.w	#72,-(sp)
	move.w	#145,-(sp)
	move.w	#35,-(sp)
	move.l	#_actor_sprites+1428,-(sp)
	jsr	_sprite_init
	lea	16(sp),sp
	move.w	#4,_actor_sprites+1448
	move.w	#127,_actor_sprites+1446
	moveq.l	#0,d0
	move.w	_level,d0
	divu	#3,d0
	swap	d0
	tst.w	d0
	bne	L28
	move.w	#3,-(sp)
	jsr	_random
	addq.w	#2,sp
	mulu	#14,d0
	moveq.l	#0,d1
	move.w	d0,d1
	add.l	#_praise,d1
	move.l	d1,a0
	pea	(a0)
	jsr	_play_GFS_sound
	addq.w	#4,sp
L29:
	move.l	#120,-(sp)
	move.l	_lastsamplesize,-(sp)
	jsr	ldivu
	addq.w	#8,sp
	move.w	d0,d3
L30:
	tst.w	d3
	beq	L31
	jsr	_read_joypad1
	move.w	d0,d4
	move.w	d0,-(sp)
	move.l	_player,-(sp)
	jsr	_handle_player
	addq.w	#6,sp
	move.w	#1,-2(a6)
L32:
	cmp.w	#40,-2(a6)
	beq	L34
	moveq.l	#42,d0
	mulu	-2(a6),d0
	moveq.l	#0,d1
	move.w	d0,d1
	add.l	#_actor_sprites,d1
	move.l	d1,a0
	pea	(a0)
	jsr	_sprite_move
	addq.w	#4,sp
	addq.w	#1,-2(a6)
	bra	L32
L34:
	move.w	#0,-2(a6)
L35:
	cmp.w	#40,-2(a6)
	beq	L37
	moveq.l	#42,d0
	mulu	-2(a6),d0
	moveq.l	#0,d1
	move.w	d0,d1
	add.l	#_actor_sprites,d1
	move.l	d1,a0
	pea	(a0)
	jsr	_sprite_draw
	addq.w	#4,sp
	addq.w	#1,-2(a6)
	bra	L35
L37:
	jsr	_wait_sync
	move.w	#80,-(sp)
	move.w	#1,-(sp)
	jsr	_show_sprite
	addq.w	#4,sp
	jsr	_sprite_prepare
	subq.w	#1,d3
	bra	L30
L31:
	clr.w	-(sp)
	clr.w	-(sp)
	clr.w	-(sp)
	move.w	#-32,-(sp)
	move.w	#-32,-(sp)
	move.w	#35,-(sp)
	move.l	#_actor_sprites+1428,-(sp)
	jsr	_sprite_init
	lea	16(sp),sp
	move.l	#_saucer_pal,-(sp)
	move.w	#2,-(sp)
	jsr	_set_colors
	addq.w	#6,sp
	move.w	#1,-(sp)
	move.w	#80,-(sp)
	move.w	#152,-(sp)
	jsr	_ai_spawn_enemy
	addq.w	#6,sp
	move.w	#0,_player_dead
L38:
	tst.w	_player_dead
	bne	L39
	tst.w	_saucers_cnt
	beq	L39
	jsr	_read_joypad1
	move.w	d0,d4
	move.w	d0,-(sp)
	move.l	_player,-(sp)
	jsr	_handle_player
	addq.w	#6,sp
	jsr	_ai_handle
	jsr	_shot_move
	move.w	#1,-2(a6)
L40:
	cmp.w	#40,-2(a6)
	beq	L42
	moveq.l	#42,d0
	mulu	-2(a6),d0
	moveq.l	#0,d1
	move.w	d0,d1
	add.l	#_actor_sprites,d1
	move.l	d1,a0
	pea	(a0)
	jsr	_sprite_move
	addq.w	#4,sp
	addq.w	#1,-2(a6)
	bra	L40
L42:
	move.w	#0,-2(a6)
L43:
	cmp.w	#40,-2(a6)
	beq	L45
	moveq.l	#42,d0
	mulu	-2(a6),d0
	moveq.l	#0,d1
	move.w	d0,d1
	add.l	#_actor_sprites,d1
	move.l	d1,a0
	pea	(a0)
	jsr	_sprite_draw
	addq.w	#4,sp
	addq.w	#1,-2(a6)
	bra	L43
L45:
	jsr	_shot_draw
	jsr	_wait_sync
	move.w	#80,-(sp)
	move.w	#1,-(sp)
	jsr	_show_sprite
	addq.w	#4,sp
	jsr	_sprite_prepare
	move.w	#28,-(sp)
	move.w	#1,-(sp)
	jsr	_gotoxy
	move.l	#L46,(sp)
	jsr	_cputs
	addq.w	#4,sp
	move.w	#8,-(sp)
	move.l	_score,-(sp)
	jsr	_write_ulong
	addq.w	#6,sp
	move.l	#L47,-(sp)
	jsr	_cputs
	addq.w	#4,sp
	move.w	#3,-(sp)
	move.w	_level,-(sp)
	jsr	_write_uint
	addq.w	#4,sp
	move.w	#28,-(sp)
	move.w	#30,-(sp)
	jsr	_gotoxy
	move.l	#L48,(sp)
	jsr	_cputs
	addq.w	#4,sp
	move.w	#3,-(sp)
	move.w	_lives,-(sp)
	jsr	_write_uint
	addq.w	#4,sp
	bra	L38
L39:
	tst.w	_player_dead
	beq	L23
	moveq.l	#30,d3
L50:
	tst.w	d3
	beq	L52
	move.w	#1,-2(a6)
L53:
	cmp.w	#40,-2(a6)
	beq	L55
	moveq.l	#42,d0
	mulu	-2(a6),d0
	moveq.l	#0,d1
	move.w	d0,d1
	add.l	#_actor_sprites,d1
	move.l	d1,a0
	pea	(a0)
	jsr	_sprite_move
	addq.w	#4,sp
	moveq.l	#42,d0
	mulu	-2(a6),d0
	moveq.l	#0,d1
	move.w	d0,d1
	add.l	#_actor_sprites,d1
	move.l	d1,a0
	pea	(a0)
	jsr	_sprite_draw
	addq.w	#4,sp
	addq.w	#1,-2(a6)
	bra	L53
L55:
	jsr	_ai_handle
	jsr	_wait_sync
	move.w	#80,-(sp)
	move.w	#1,-(sp)
	jsr	_show_sprite
	addq.w	#4,sp
	jsr	_sprite_prepare
	subq.w	#1,d3
	bra	L50
L52:
	subq.w	#1,_lives
	bra	L23
L28:
	move.w	#5,-(sp)
	jsr	_random
	addq.w	#2,sp
	mulu	#14,d0
	moveq.l	#0,d1
	move.w	d0,d1
	add.l	#_taunts,d1
	move.l	d1,a0
	pea	(a0)
	jsr	_play_GFS_sound
	addq.w	#4,sp
	bra	L29
L24:
	tst.w	_lives
	beq	L13
	moveq.l	#50,d0
	mulu	_level,d0
	add.w	#100,d0
	moveq.l	#0,d1
	move.w	d0,d1
	add.l	d1,_score
	addq.w	#1,_level
L13:
	movem.l	(sp)+,d3/d4
	unlk	a6
	rts
	.text
	.globl	_handle_player
_handle_player:
	link	a6,#0
	movem.l	d3/a3,-(sp)
	move.l	8(a6),a3
	move.w	12(a6),d3
	move.w	#0,24(a3)
	move.w	d3,d0
	and.w	#4,d0
	beq	L60
	sub.w	#2048,24(a3)
L61:
	move.w	d3,d0
	and.w	#96,d0
	beq	L63
	tst.w	_saucers_deployed
	beq	L63
	tst.w	_shot_dly
	bne	L63
	move.w	#1,-(sp)
	move.w	#245,-(sp)
	move.w	#1600,-(sp)
	move.w	_cur_angle,d0
	add.w	#64,d0
	move.w	d0,-(sp)
	move.w	#12,-(sp)
	move.w	4(a3),d0
	addq.w	#8,d0
	move.w	d0,-(sp)
	move.w	2(a3),d0
	addq.w	#8,d0
	move.w	d0,-(sp)
	jsr	_shot_shoot
	lea	14(sp),sp
	move.w	#15,-(sp)
	move.w	#1,-(sp)
	jsr	_set_vol
	move.l	#_shot2,(sp)
	move.w	#1,-(sp)
	jsr	_start_sound
	addq.w	#6,sp
	move.w	#15,_shot_dly
L63:
	tst.w	_shot_dly
	beq	L65
	cmp.w	#1,_shot_dly
	beq	L66
	subq.w	#1,_shot_dly
L65:
	move.l	a3,-(sp)
	jsr	_sprite_move
	addq.w	#4,sp
	tst.w	2(a3)
	bge	L69
	move.w	#0,2(a3)
	move.w	24(a3),d0
	neg.w	d0
	move.w	d0,24(a3)
L70:
	move.w	#1,-(sp)
	move.w	4(a3),d0
	add.w	#20,d0
	move.w	d0,-(sp)
	move.w	2(a3),d0
	add.w	#20,d0
	move.w	d0,-(sp)
	move.w	4(a3),d0
	addq.w	#4,d0
	move.w	d0,-(sp)
	move.w	2(a3),d0
	addq.w	#4,d0
	move.w	d0,-(sp)
	jsr	_shot_at
	lea	10(sp),sp
	tst.w	d0
	beq	L59
	jsr	_kill_player
L59:
	movem.l	(sp)+,d3/a3
	unlk	a6
	rts
L69:
	cmp.w	#296,2(a3)
	ble	L70
	move.w	#296,2(a3)
	move.w	24(a3),d0
	neg.w	d0
	move.w	d0,24(a3)
	bra	L70
L66:
	move.w	d3,d0
	and.w	#96,d0
	bne	L65
	move.w	#0,_shot_dly
	bra	L65
L60:
	move.w	d3,d0
	and.w	#8,d0
	beq	L61
	add.w	#2048,24(a3)
	bra	L61
	.data
L83:	.dc.b	$42,$4f,$4f,$4d,$35,$2e,$53,$4e,$44
	.dc.b	0
L48:	.dc.b	$4c,$49,$56,$45,$53,$3a,$20
	.dc.b	0
L47:	.dc.b	$20,$20,$4c,$45,$56,$45,$4c,$3a,$20
	.dc.b	0
L46:	.dc.b	$53,$43,$4f,$52,$45,$3a,$20
	.dc.b	0
L22:	.dc.b	$53,$4b,$55,$4c,$4c,$2e,$52,$44,$43
	.dc.b	0
L21:	.dc.b	$56,$4f,$52,$54,$45,$58,$2e,$52,$44,$43
	.dc.b	0
L20:	.dc.b	$54,$52,$41,$43,$45,$52,$2e,$52,$44,$43
	.dc.b	0
L19:	.dc.b	$47,$55,$49,$44,$45,$44,$2e,$52,$44,$43
	.dc.b	0
L18:	.dc.b	$4d,$49,$53,$53,$49,$4c,$45,$53,$2e,$52,$44
	.dc.b	$43
	.dc.b	0
L17:	.dc.b	$53,$41,$55,$43,$45,$52,$2e,$52,$44,$43
	.dc.b	0
L16:	.dc.b	$45,$58,$50,$4c,$4f,$2e,$52,$44,$43
	.dc.b	0
L15:	.dc.b	$50,$4c,$41,$59,$45,$52,$2e,$52,$44,$43
	.dc.b	0
L14:	.dc.b	$53,$48,$4f,$54,$53,$2e,$52,$44,$43
	.dc.b	0
L6:	.dc.b	$46,$4f,$4e,$54,$2e,$43,$48,$52
	.dc.b	0
L2:	.dc.b	$53,$4f,$53,$4f,$4f,$4e,$2e,$53,$4e,$44
	.dc.b	0
L1:	.dc.b	$50,$41,$54,$48,$45,$54,$49,$43,$2e,$53,$4e
	.dc.b	$44
	.dc.b	0
L0:	.dc.b	$49,$53,$4d,$49,$4e,$45,$2e,$53,$4e,$44
	.dc.b	0
	.text
	.globl	_kill_player
_kill_player:
	link	a6,#0
	movem.l	d3-d5,-(sp)
	moveq.l	#16,d3
L76:
	tst.w	d3
	beq	L78
	clr.w	-(sp)
	move.l	_player,a0
	move.w	4(a0),d0
	addq.w	#4,d0
	move.w	d0,-(sp)
	move.l	_player,a0
	move.w	2(a0),d0
	addq.w	#4,d0
	move.w	d0,-(sp)
	jsr	_ai_spawn_enemy
	addq.w	#6,sp
	move.w	d0,d5
	beq	L77
	moveq.l	#3,d4
L80:
	tst.w	d4
	beq	L77
	move.w	d4,d0
	moveq.l	#9,d1
	lsl.w	d1,d0
	move.w	d0,-(sp)
	move.w	d3,d0
	lsl.w	#4,d0
	move.w	d0,-(sp)
	move.w	d5,d0
	subq.w	#1,d0
	lsl.w	#4,d0
	moveq.l	#0,d1
	move.w	d0,d1
	add.l	#_ai_recs,d1
	move.l	d1,a0
	pea	(a0)
	jsr	_ai_accelerate
	addq.w	#8,sp
	subq.w	#1,d4
	bra	L80
L77:
	subq.w	#1,d3
	bra	L76
L78:
	move.l	#L83,-(sp)
	jsr	_play_GFS_sound
	addq.w	#4,sp
	move.w	#1,_player_dead
	movem.l	(sp)+,d3-d5
	unlk	a6
	rts
